# network

数据结构和数据库介绍完了以后，剩下的就是网络这块。

网络这块主要分成三大部分：

1. 系统初始化
2. 网络
3. I/O的多路复用

## I/O多路复用

I/O的多路复用这里，我们只介绍epoll的实现方式。

I/O多路复用问题，可以形象的比喻成文件读写事件的响应，这里主要明白的一点，什么是事件？操作系统是如何识别一个事件的？

当时不理解的原因，主要是没有把操作系统加入到这里面进行讨论，刚开始仅仅从语言层面来考虑问题，所以一直没有办法理解。

当把操作系统加入讨论以后，整个的逻辑就变得清楚了。

事件：系统中发生了某个特定的行为，统称为事件。

当某个事件发生的时候，操作系统会有一个事件注册中心，操作系统会从事件注册中心获取对应的事件的响应方法，并执行它。

有了这个概念以后，我们来说说I/O的多路复用的实现。

1. 获取一个文件fd
2. 创建一个事件监听器
3. 将文件fd的读事件以及事件的处理方法和参数注册到事件监听器
4. 等待事件触发

## redis的单线程原理

redis采用事件处理触发的概念。

网络连接的时候，服务端会生成一个监听套接字，这个套接字就是一个fd。redis就是通过监听这个套接字，处理网络请求的事件，就是通过监听这个套接字实现的。

这里对我来说是一个坑，这个和我之前的阅读的网络编程的例子的实现是不一样的，我一直在找fork和线程，但是一直找不到，后来也是通过博客才了解redis是单进程单线程处理网络请求的。

当监听套接字可读的时候，系统时间就会触发读事件，然后执行注册函数acceptTcpHandler。
